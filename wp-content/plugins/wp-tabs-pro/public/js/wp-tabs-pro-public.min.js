!(function ($) {
  "use strict";
  $(document).ready(function () {
    $('div[id^="sp-tabpro-wrapper_"]').each(function () {
      var _this,
        tabsID = $(this).attr("id"),
        preloader = $("#" + tabsID).data("preloader"),
        activemode = $("#" + tabsID).data("activemode"),
        autoplaytime = $("#" + tabsID).data("autoplaytime"),
        pause_on_hover = $("#" + tabsID).data("pause_on_hover"),
        valignfill = $("#" + tabsID).data("valignfill"),
        hush_url = $("#" + tabsID).data("hush_url"),
        animate_scroll_top = $("#" + tabsID).data("animate_scroll_top"),
        tab_resize = $("#" + tabsID).data("tab_resize_event"),
        enable_scrollable_tabs = $("#" + tabsID + " .sp-tab__nav").hasClass(
          "sp-tab__nav-tabs-scrollable"
        );
      if (
        (preloader &&
          $(document).ready(function () {
            $(".sp-tab__preloader", "#" + tabsID).fadeOut();
          }),
        $("#" + tabsID + " > .sp-tab__tab-content > .sp-tab__tab-pane").each(
          function () {
            $(this).find(".sp-tab__nav-tabs-scrollable").length > 0 &&
              $(this).addClass("has-tabs-scrollable");
          }
        ),
        enable_scrollable_tabs)
      ) {
        var vertical_tabs = !!$("#" + tabsID).hasClass("tab-layout-vertical"),
          variableWidth =
            !vertical_tabs &&
            $("#" + tabsID + " > .sp-tab__nav").data("variable_width");
        if (
          ($("#" + tabsID + "> .sp-tab__nav-link").on("click", function () {
            $(this)
              .find("sp-tab__active")
              .removeClass("sp-tab__active")
              .next()
              .addClass("sp-tab__active");
          }),
          vertical_tabs)
        ) {
          var slick_item_width = 0;
          $("#" + tabsID + " > .sp-tab__nav .sp-tab__nav-item").each(function (
            i,
            item
          ) {
            slick_item_width < $(item).width() &&
              (slick_item_width = $(item).width());
          }),
            $("#" + tabsID + " > .sp-tab__nav").css(
              "maxWidth",
              slick_item_width + "px"
            ),
            $("#" + tabsID + " > .sp-tab__tab-content").css(
              "maxWidth",
              "calc( 100% - " + slick_item_width + "px )"
            );
        }
        "slick" in $.fn &&
          "function" == typeof $.fn.slick &&
          ($(
            "#" +
              tabsID +
              "> .sp-tab__nav-tabs-scrollable:not(.slick-initialized)"
          ).on("init", function (event, slick, direction) {
            $("#" + tabsID + " > .sp-tab__nav-tabs-scrollable .sp-tab__active")
              .parents(".sp-tab__nav-item")
              .addClass("sp-tab_slide_active"),
              add_arrow_before(tabsID);
          }),
          $(
            "#" +
              tabsID +
              "> .sp-tab__nav-tabs-scrollable:not(.slick-initialized)"
          ).slick({
            vertical: vertical_tabs,
            cssEase: "cubic-bezier(0.645, 0.045, 0.355, 1.000)",
            variableWidth: variableWidth,
            draggable: !1,
          }),
          $(document).on(
            "click",
            "#" +
              tabsID +
              " > .sp-tab__nav-tabs-scrollable > .slick-arrow:not(.arrow-disabled), #" +
              tabsID +
              " > .sp-tab__nav-tabs-scrollable > .next-before, #" +
              tabsID +
              " > .sp-tab__nav-tabs-scrollable > .prev-before",
            function (e) {
              $(
                "#" + tabsID + " > .sp-tab__nav-tabs-scrollable .slick-arrow"
              ).removeClass("arrow-disabled"),
                $(this).hasClass("slick-disabled") &&
                  $(this).addClass("arrow-disabled");
              var tab_slide_active,
                currentIndex = $(
                  "#" +
                    tabsID +
                    " > .sp-tab__nav-tabs-scrollable li.sp-tab_slide_active"
                ).data("slick-index"),
                nextIndex = currentIndex + 1;
              if (
                (($(this).hasClass("prev-before") ||
                  $(this).hasClass("slick-prev")) &&
                  (nextIndex = currentIndex - 1),
                $(
                  "#" +
                    tabsID +
                    ' > .sp-tab__nav-tabs-scrollable li[data-slick-index="' +
                    nextIndex +
                    '"]'
                ).length > 0)
              ) {
                e.preventDefault,
                  $("#" + tabsID + " > .sp-tab__nav-tabs-scrollable li")
                    .removeClass("sp-tab_slide_active")
                    .find(".sp-tab__nav-link")
                    .removeClass("sp-tab__active"),
                  $(
                    "#" +
                      tabsID +
                      ' > .sp-tab__nav-tabs-scrollable li[data-slick-index="' +
                      nextIndex +
                      '"]'
                  )
                    .addClass("sp-tab_slide_active")
                    .children(".sp-tab__nav-link")
                    .addClass("sp-tab__active"),
                  setTimeout(function () {
                    if (
                      $(
                        "#" +
                          tabsID +
                          " > .sp-tab__nav-tabs-scrollable .slick-cloned.sp-tab_slide_active:not(.slick-active)"
                      ).length > 0
                    ) {
                      var hash_id = $(
                        "#" +
                          tabsID +
                          " > .sp-tab__nav-tabs-scrollable .slick-cloned.sp-tab_slide_active:not(.slick-active)"
                      )
                        .removeClass("sp-tab_slide_active")
                        .children(".sp-tab__nav-link")
                        .attr("for");
                      $(
                        "#" +
                          tabsID +
                          ' > .sp-tab__nav-tabs-scrollable .slick-active label[for="' +
                          hash_id +
                          '"]'
                      )
                        .addClass("sp-tab__active")
                        .parent(".slick-active")
                        .addClass("sp-tab_slide_active"),
                        add_arrow_before(tabsID);
                    }
                  }, 300),
                  $(
                    "#" + tabsID + ">.sp-tab__tab-content> .sp-tab__tab-pane"
                  ).removeClass("sp-tab__active");
                var selector = $(
                  "#" +
                    tabsID +
                    ' > .sp-tab__nav-tabs-scrollable  [data-slick-index="' +
                    nextIndex +
                    '"]'
                )
                  .children(".sp-tab__nav-link")
                  .attr("for");
                $(selector).addClass("sp-tab__active");
              }
              add_arrow_before(tabsID);
            }
          ),
          $(document).on(
            "click",
            "#" + tabsID + " > .sp-tab__nav-tabs-scrollable li",
            function () {
              $("#" + tabsID + " > .sp-tab__nav-tabs-scrollable li")
                .removeClass("sp-tab_slide_active")
                .find(".sp-tab__nav-link")
                .removeClass("sp-tab__active"),
                $(this)
                  .addClass("sp-tab_slide_active")
                  .find(".sp-tab__nav-link")
                  .addClass("sp-tab__active"),
                add_arrow_before(tabsID);
            }
          ));
      }
      function add_arrow_before(tabsID) {
        $(
          "#" +
            tabsID +
            "> .sp-tab__nav-tabs-scrollable .sp-tab_slide_active + .slick-active"
        ).length > 0
          ? $(document).find(
              "#" + tabsID + "> .sp-tab__nav-tabs-scrollable .next-before"
            ).length < 1 &&
            $("#" + tabsID + "> .sp-tab__nav-tabs-scrollable").append(
              '<span class="next-before"></span>'
            )
          : $(document)
              .find(
                "#" + tabsID + "> .sp-tab__nav-tabs-scrollable .next-before"
              )
              .remove(),
          $(
            "#" +
              tabsID +
              "> .sp-tab__nav-tabs-scrollable .slick-active + .sp-tab_slide_active"
          ).length > 0
            ? $(document).find(
                "#" + tabsID + "> .sp-tab__nav-tabs-scrollable .prev-before"
              ).length < 1 &&
              $("#" + tabsID + "> .sp-tab__nav-tabs-scrollable").prepend(
                '<span class="prev-before"></span>'
              )
            : $(document)
                .find(
                  "#" + tabsID + "> .sp-tab__nav-tabs-scrollable .prev-before"
                )
                .remove();
      }
      if ("tabs-activator-event-auto" == activemode) {
        let tabInterval;
        var tabChange = function () {
          var tabs = $("#" + tabsID + " .sp-tab__nav-tabs > li"),
            active = $(tabs).find("label.sp-tab__active").parent("li");
          $(active).next().find("label").hasClass("sp-tab__disabled")
            ? $(active).next().next().find("label").trigger("click")
            : $(active).next().find("label").trigger("click"),
            active.next().length ||
              $("#" + tabsID + " > ul .sp-tab__nav-item:nth-of-type(1)")
                .find("label")
                .trigger("click");
        };
        function startTabCycling() {
          tabInterval = setInterval(tabChange, autoplaytime);
        }
        function stopTabCycling() {
          clearInterval(tabInterval);
        }
        if ((startTabCycling(), pause_on_hover)) {
          var tabsContainer = $("#" + tabsID);
          $(tabsContainer).on("mouseover", function () {
            stopTabCycling();
          }),
            $(tabsContainer).on("mouseout", function () {
              startTabCycling();
            });
        }
      }
      "tabs-activator-event-hover" == activemode &&
        $("#" + tabsID).on(
          "mouseenter.sp.tab.data-api",
          '[data-sptoggle="tab"], [data-hover="tab"]',
          function () {
            $(this).sp_tab("show"),
              1 == tab_resize && $(window).trigger("resize");
          }
        ),
        1 == valignfill &&
          $(function () {
            var byRow = $("body").hasClass("sp-tab__lay-default");
            $("#" + tabsID + " .sp-tab__tab-content").each(function () {
              $(this)
                .children(".sp-tab__tab-pane")
                .matchHeight({ byRow: byRow });
            });
          });
      var sptproID = document.getElementById(tabsID),
        sptproCls = sptproID.getElementsByClassName("sp-tab__tab-pane"),
        isScrollbar,
        sptproCount;
      if (void 0 !== $(sptproID).find(".sp-tab__tab-pane").data("scrollbar"))
        for (sptproCount = 0; sptproCount < sptproCls.length; sptproCount++)
          Scrollbar.init(sptproCls[sptproCount]);
      $("#" + tabsID + " .sp-tab__collapse").on(
        "shown.bs.collapse",
        function (e) {
          var $panel = $(this).closest(".sp-tab__tab-pane");
          animate_scroll_top &&
            $("html,body").animate({ scrollTop: $panel.offset().top }, 300);
        }
      ),
        $(".sp-tab__collapse").on("hide.bs.collapse", function (e) {
          var $panel;
          $(this)
            .closest(".sp-tab__tab-pane")
            .find("label")
            .removeClass("sp_tab-accordion-collapse-icon");
        }),
        $("a[href*='#']").on("click", function () {
          var theTarget = $(this).prop("hash");
          $(
            "#" + tabsID + ' .sp-tab__nav-tabs > li [for="' + theTarget + '"]'
          ).trigger("click");
        }),
        $(function () {
          "" != window.location.hash &&
            ($(
              "#" +
                tabsID +
                ' .sp-tab__nav-tabs > li [for="' +
                window.location.hash +
                '"]'
            ).trigger("click"),
            $("#" + tabsID).hasClass("sp-tab__default-accordion") &&
              $(window.location.hash + ".sp-tab__collapse").collapse("show"));
        });
      var $tabs = $("#" + tabsID + " .sp-tab__nav-item"),
        $panels = $("#" + tabsID + " .sp-tab__tab-pane"),
        $key_control = $(
          "#" + tabsID + " .sp-tab__nav-item, #" + tabsID + " .sp-tab__tab-pane"
        );
      $("label", $tabs).on("click", function (e) {
        if ((e.preventDefault(), "1" == hush_url)) {
          var test = $(this).attr("for");
          history.replaceState(void 0, void 0, test);
        }
      }),
        $tabs.on("click", "label", function (e) {
          e.preventDefault();
          var id = $(this).attr("for");
          1 == tab_resize && $(window).trigger("resize"),
            $tabs
              .find('[aria-selected="true"]')
              .attr({ "aria-selected": !1, tabindex: -1 }),
            $(this).attr({ "aria-selected": !0, tabindex: 0 }),
            $panels
              .filter('[aria-hidden="false"]')
              .attr({ "aria-hidden": !0, tabindex: -1 }),
            $(id).attr({ "aria-hidden": !1, tabindex: 0 });
        }),
        $key_control.on("keydown", function (e) {
          switch (e.keyCode) {
            case 39:
              $tabs
                .find('[aria-selected="true"]')
                .parents("li")
                .next()
                .children("label")
                .click()
                .focus();
              break;
            case 37:
              $tabs
                .find('[aria-selected="true"]')
                .parents("li")
                .prev()
                .children("label")
                .click()
                .focus();
          }
        }),
        $(
          "#" + tabsID + ' iframe:not(.wp-tab-iframe,.skip,[src*="omny.fm/"])'
        ).each(function (i) {
          let max_width =
            $(this).attr("width") > 100
              ? "max-width:" + $(this).attr("width") + "px"
              : "";
          $(this)
            .addClass("wp-tab-iframe")
            .wrap(
              "<div class='" +
                tabsID +
                "_" +
                i +
                " ' style='" +
                max_width +
                "'></div>"
            )
            .wrap("<div class='wp-tab-iframe-container'></div>");
        });
      var small_screen_type = $("#" + tabsID + " .sp-tab__nav-tabs").data(
          "small-screen-type"
        ),
        small_screen_size = $("#" + tabsID + " .sp-tab__nav-tabs").data(
          "screen-size"
        );
      "accordion_mode" === small_screen_type &&
        $(window).width() < small_screen_size &&
        $("#" + tabsID + " .sp-tab__card .sp-tab__card-header").css(
          "display",
          "block"
        );
    }),
      $(".sp-tab__lay-default").addClass("sp-tab__lay-default-loaded");
  });
})(jQuery);
